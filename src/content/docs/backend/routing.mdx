---
title: Routing
description: Routing in mapl/web
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

Here's a `@mapl/web` API with a route that simply return `Hi`.
```ts
// server.js
import { router, send } from '@mapl/web';
import { compiler } from '@mapl/web/generic';

const app = router.init([], [
  router.get('/', send.raw(() => 'Hi'))
]);

export default {
  fetch: compiler.buildSync(app)()
};
```

Run the server with [`srvx`](https://srvx.h3.dev/guide/cli) CLI:
<Tabs syncKey='packageManager'>
  <TabItem label='npm' icon='seti:npm'>
    ```sh showLineNumbers=false
    npx srvx --port=8080 server.js
    ```
  </TabItem>
  <TabItem label='bun' icon='bun'>
    ```sh showLineNumbers=false
    bun x --bun srvx --port=8080 server.js
    ```
  </TabItem>
  <TabItem label='pnpm' icon='pnpm'>
    ```sh showLineNumbers=false
    pnpx srvx --port=8080 server.js
    ```
  </TabItem>
  <TabItem label='yarn' icon='seti:yarn'>
    ```sh showLineNumbers=false
    yarn dlx srvx --port=8080 server.js
    ```
  </TabItem>
</Tabs>

Navigate to http://localhost:8080, you should see `Hi` as the result.

## Route patterns
`@mapl/web` supports these patterns:
```ts
// From highest to lowest priority
'/static' // Static routes
'/user/*/dashboard' // Capture one path segment
'/search/**' // Capture all path segments after '/search'
```

Example usage:
```ts
const app = router.init([], [
  router.get(
    '/',
    send.raw(() => 'Hi')
  ), // '/' => 'Hi'

  router.get(
    '/user/*',
    send.raw((id) => 'User: ' + id)
  ), // '/user/reve' => 'User: reve'

  router.get(
    '/search/**',
    send.raw((rest) => 'Search results for: ' + rest)
  ) // '/search/a/b' => 'Search results for: a/b'
]);
```

## Subroutes
Subroutes can be used to declare multiple routes with the same prefix.
```ts
const user = router.init([], [
  router.get('/profile', () => ...),
  router.get('/login', () => ...)
]);

const app = router.init([], [
  router.get('/', () => ...)
], {
  // register as /user/profile and /user/login
  '/user': user,
});
```
